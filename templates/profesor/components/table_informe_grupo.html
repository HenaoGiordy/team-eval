{% load custom_filters %}
<h3>Grupo: {{ grupo.nombre }}</h3>
<table class="table table-hover">
  <thead>
    <tr>
      <th>Estudiante</th>
      {% for criterio in criterios %}
        <th>{{ criterio.descripcion }} (Peso: {{ criterio.peso }})</th>
      {% endfor %}
      <th>Suma Ponderada</th>
    </tr>
  </thead>
  <tbody>
    {% for estudiante in grupo.estudiantes.all %}
    <tr>
        <td>{{ estudiante.nombre }}</td>
      
        {% for criterio in criterios %}
            {% with estudiante_id=estudiante.id %}
                {% for resultado in resultados %}
                    {% if resultado.evaluado_id == estudiante_id and resultado.criterio_evaluado__descripcion == criterio.descripcion %}
                        <td>
                            Promedio: {{ resultado.promedio_notas }} -- Ponderado: {{ resultado.valor_ponderado }}
                            <input value="{{ resultado.valor_ponderado }}" type="hidden" class="valor-ponderado">
                        </td>
                    {% endif %}
                {% endfor %}
            {% endwith %}
        {% endfor %}
      
        <td class="suma-ponderada">
            {{ totales_por_evaluado|get_item:estudiante.id|floatformat:2 }}
        </td>
    </tr>
    {% endfor %}
  </tbody>
</table>
